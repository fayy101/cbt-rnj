<script>
  async function loginCBT() {
    const nama = document.getElementById("nama").value;
    const paket = document.getElementById("paket").value;
    const kelas = document.getElementById("kelas").value;
    const jurusan = document.getElementById("jurusan").value;

    if (!nama || !paket || !kelas) {
      alert("Mohon lengkapi semua data.");
      return;
    }

    // Kirim data ke Google Sheets
    try {
      await fetch("https://script.google.com/macros/s/AKfycbwlT8bu_E3UNptX7w_8OVMq_uJkEmcZZyAlHUiNdzC5rLUBlrvfQkaxvzpCRuNU-tXM/exec", {
        method: "POST",
        body: JSON.stringify({ nama, paket, kelas, jurusan }),
        headers: { "Content-Type": "application/json" }
      });
    } catch (error) {
      alert("Gagal mengirim data: " + error.message);
      return;
    }

    // Arahkan ke folder soal
    const folderMap = {
      "Kelas 4": "https://drive.google.com/drive/folders/1gz1JCoUcsfnEBquD8Jhvk-xfhaO7AwYj",
      "Kelas 5": "https://drive.google.com/drive/folders/1Mla_WbuSFj_S9XMMWpnUlGW1VdNUhOgW",
      "Kelas 6": "https://drive.google.com/drive/folders/1RpW1UCG-TrS76kq_gkY614nJvWZTAt1r",
      "Kelas 7": "https://drive.google.com/drive/folders/1yOiem5ArNQQvMlbNIEXP2dqasfR03GSw",
      "Kelas 8": "https://drive.google.com/drive/folders/1_M_nxHoe8la4k-udo5ZV0nD4iNBXSUAx",
      "Kelas 9": "https://drive.google.com/drive/folders/16tsOe5RRgGMlIzNJRFeVfW5Dpb9WFq3u",
      "Kelas 10 IPA": "https://drive.google.com/drive/folders/15EnxsFL52KdnctLrn1Wk-KnPxJRGuVgF",
      "Kelas 10 IPS": "https://drive.google.com/drive/folders/1EOydA3f4iyaAmHZRfkYjJM-TjQ4UMAXX",
      "Kelas 11 IPA": "https://drive.google.com/drive/folders/1ryXV8AGe4MxqGolS24byJXYA4ud1HB-X",
      "Kelas 11 IPS": "https://drive.google.com/drive/folders/11J3KL1H-MZvSxOUIlCoE9JWyRpsedoN3",
      "Kelas 12 IPA": "https://drive.google.com/drive/folders/1o-wfDN0AmVD_W0l4ndy83qc2A0kyBxg2",
      "Kelas 12 IPS": "https://drive.google.com/drive/folders/1cX8oLt1OvHGqD7cx3VpkwUCrdpqCqpZm"
    };

    const key = `Kelas ${kelas}`;
    const linkSoal = folderMap[key];

    if (linkSoal) {
      window.location.href = linkSoal;
    } else {
      alert("Link soal belum tersedia untuk kombinasi ini.");
    }
  }
</script>
